<html>
  <body>
    <h1>1</h1>

    <div class="cons">x</div>

    <a href="demo.html">xxxxxxxxxxx</a>

    <script>


        let print = (s) => {
            console.log('####',s);
            document.querySelector(".cons").innerHTML = document.querySelector(".cons").innerHTML + '<br\>' + s;
        };

        let record = (what, ev, props) => {
            //console.log(ev);
            let r = props.reduce((a, prop) => {
                    if (ev[prop]) {
                        a[prop] = ev[prop]; 
                    };
                    return a;
                }, {});
            r['what'] = what;
            r['t'] = Date.now();
            //console.log(r);
            print(what + ' :: ' + JSON.stringify(r));
        }

        //updateFieldIfNotNull = (what, v) => {
          //  if (v) print(what  + ' ... ' + v);
        //}

        let handleOrientation = (ev) => {
            record('orientation', ev, ['alpha', 'beta', 'gamma', 'timeStamp'])
        }
        
        let handleMotion = (ev) => {
            record('motion', ev, ['accelerationIncludingGravity', 'acceleration', 'interval', 'rotationRate', 'timeStamp']);
        }

        let main = () => {
            window.addEventListener("devicemotion", handleMotion);
            window.addEventListener("deviceorientation", handleOrientation);
        }

        main();
    </script>
  </body>
</html>
